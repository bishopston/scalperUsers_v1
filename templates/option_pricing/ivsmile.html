{%  extends "../base/base.html" %}
{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<div class="container light-blue text-dark mb-3 d-flex flex-wrap overflow-auto">

    <div class="row">
        <div class="col-md-12">
            <canvas id="ivseriesChart" width="400" height="200">
        </div>
    </div>
</div>

<script> 

    var assetId = "{{qs_asset}}"
    var optiontypeId = "{{qs_optiontype}}"
    var expmonthId = "{{qs_month}}"
    var expyearId = "{{qs_year}}"
    var dataURL = `/ivscreeners/${assetId}/${optiontypeId}/${expmonthId}/${expyearId}/`

    var ivstate ={	
		'items':[],
		'values':[]  
	}

    $.ajax({
        method: "GET",
        url: dataURL,
        success: function(response){
            for (var i in response){
                var key = Object.keys(response[i])[0]
				var value = Object.values(response[i])[0]
           
				ivstate.items.push(key)
                ivstate.values.push(value)

            console.log(ivstate.items)
            console.log(ivstate.values)
            }

        },
        error: function(error_data){
            console.log("error")
            console.log(error_data)
        }
    })
    
    var ctx = document.getElementById("ivseriesChart").getContext('2d');
    
    var ivseriesChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ivstate.items,
        datasets: [{
            label: assetId.concat(' Volatility Smile'),
            data: ivstate.values,
            yAxisID: 'A',
            borderWidth: 1,
            borderColor: 'rgba(66,139,202)',
            fill: true,
            order: 1
        },
        ]
    },
    options: {
        scales: {
            yAxes: [{
                id: 'A',
                position: 'left',
                type: 'linear',
                ticks: {
                    beginAtZero:true
                }
            },
            ],
            xAxes: [{
                ticks: {
                    maxRotation: 45,
                    minRotation: 45
                }
            }]
        },
        legend: {
            display: true,
        }
    }
    })

</script>

<canvas id="myChart" width="400" height="400"></canvas>
<script>
var ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
        datasets: [{
            label: '# of Votes',
            data: [12, 19, 3, 5, 2, 3],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});
</script>


{% endblock %}